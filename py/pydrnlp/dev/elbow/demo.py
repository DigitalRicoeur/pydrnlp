# -*- coding: utf-8 -*-
"""
@author: James Broda
"""

from pydrnlp.elbow.new import threshold_KDE, threshold_OTSU
import matplotlib.pyplot as plt
import numpy as np
import scipy.stats


def show_all():
    for label, sample_values in sorted(data.items(), reverse=True):
        _do_plot(sample_values, figure_label=label)
    plt.show()


def show(arg):
    found = data.get(arg)
    if found:
        _do_plot(found, figure_label=arg)
    else:
        _do_plot(arg)
    plt.show()

        
def _do_plot(sample_values, figure_label=None):
    """Note: sample_values should be between 0 and 1"""
    density = scipy.stats.gaussian_kde(sample_values)
    scipy.stats.describe(sample_values)
    xs = np.linspace(0, 1, 1000)
    ys = density(xs)
    kde_threshold = threshold_KDE(sample_values)
    otsu_threshold = threshold_OTSU(sample_values)
    ###
    #plt.figure(figsize=(3,6), dpi=200)
    plt.figure(num=figure_label)
    ax1=plt.gca()
    plt.plot(xs, ys, 'g')
    ax1.fill_between(xs, 0, ys,  facecolor='green', alpha=0.4)
    plt.scatter(sample_values, density(sample_values), alpha = 0.6)
    plt.axvline(x=kde_threshold, color = 'r' , label = 'KDE')
    plt.axvline(x=otsu_threshold, color = 'b', label = 'OTSU')
    plt.legend()

data = {"a": [0.8081340919957062, 0.6179510463077619, 0.5229186213541697, 0.5019875789092665, 0.44859991167337077, 0.4357184593305059, 0.4330352547260355, 0.3885789838588546, 0.38552508258940815, 0.3023798758637535, 0.2655629457736097, 0.24719952813811774, 0.2468809768512222, 0.19081083744302454, 0.1306548497193395, 0.09699061704493764, 0.08032843356904958, 0.0681023871591266, 0.04118347332907288, 0.034425052698358674, 0.029137979161082798, 0.018339623571629826, 0.013958002850839951, 0.011056442000777489, 0.010827281773396893, 0.008130895001331403, 0.006237678222204458, 0.0059533319925391005, 0.0005563276753560432, 0.0005363387286310047, 0.0005118190686093149, 0.0005060354948939789, 0.0005003811698423302, 0.0004948518087455755, 0.0004948518087455755, 0.0004948518087455755, 0.0004894433142142254, 0.0004894433142142254, 0.0004841517660522115, 0.0004841517660522115, 0.0004789734117808259, 0.0004789734117808259, 0.0004789734117808259, 0.0004739046577643449, 0.00046894206089323275, 0.00046894206089323275, 0.00046894206089323275, 0.00046408232078447704, 0.00046408232078447704, 0.0004593222724619269, 0.0004593222724619269, 0.0004593222724619269, 0.0004593222724619269, 0.0004546588794825198, 0.0004546588794825198, 0.0004546588794825198, 0.00045008922747702705, 0.00045008922747702705, 0.00044561051807644447, 0.0004412200631974309, 0.0004412200631974309, 0.0004412200631974309, 0.0004412200631974309, 0.0004369152796622727, 0.0004369152796622727, 0.0004369152796622727, 0.0004369152796622727, 0.0004326936841307487, 0.0004326936841307487, 0.00042449059451410756, 0.00042449059451410756, 0.0004205045912824809, 0.0004205045912824809, 0.00041659274949559186, 0.00041659274949559186, 0.00041659274949559186, 0.00041659274949559186, 0.0004127530185176787, 0.0004127530185176787, 0.00040898342262526673, 0.00040898342262526673, 0.00040898342262526673, 0.0004016470876078599, 0.0003980767419895377, 0.0003980767419895377, 0.0003945693125578799, 0.0003945693125578799, 0.0003911231507861228, 0.0003911231507861228, 0.00038773666524166375, 0.00038773666524166375, 0.00038440831913556925, 0.00038113662799721924, 0.00037792015746669573, 0.0003747575211980182, 0.0003747575211980182, 0.0003747575211980182, 0.0003716473788667862, 0.00036557943355593366, 0.00036557943355593366, 0.00036557943355593366, 0.00036557943355593366, 0.0003597064496773484, 0.0003597064496773484, 0.00034850895185384404, 0.00034850895185384404, 0.0003458176652799068, 0.0003431676259639753, 0.0003431676259639753, 0.00034055789287030407, 0.0003379875533727825, 0.000335455722190866, 0.0003329615403729768, 0.0003329615403729768, 0.0003329615403729768, 0.0003305041743249215, 0.0003305041743249215, 0.0003280828148810172, 0.0003256966764157517, 0.00032102703255736803, 0.00032102703255736803, 0.00031648939715399907, 0.0003142683456122516, 0.0003142683456122516, 0.0003142683456122516, 0.0003120782505074284, 0.0003099184691244154, 0.0003099184691244154, 0.0003077883764178133, 0.0003077883764178133, 0.0003056873644088571, 0.0003056873644088571, 0.0003036148416068672, 0.0003036148416068672, 0.00030157023245407766, 0.0002995529767927459, 0.0002936599495768013, 0.00028985841054048067, 0.00028799431292620765, 0.0002861540383617056, 0.00027729452216449115, 0.00027558804493853955, 0.000272237334596935, 0.000272237334596935, 0.000272237334596935, 0.000270592349265216, 0.0002689671240753146, 0.00026420651188922346, 0.0002626568708264409, 0.0002626568708264409, 0.0002581151303293162, 0.0002566359206539913, 0.00025372778739167766, 0.0002522982971858609, 0.0002453858369049481, 0.00024404855010749527, 0.00023884205042138973, 0.00023263820920481863, 0.00021376022182466344, 0.0001877679002418439]
        , "b": [0.809131497440101, 0.7402329465125764, 0.6819523380358796, 0.6691825604918138, 0.6671417203601769, 0.6080562707889553, 0.5997990338028979, 0.5633462612955326, 0.5600001670214128, 0.5242905549121757, 0.5197819290731223, 0.5123701727935016, 0.5033820645782489, 0.4244273882126703, 0.3363846678482656, 0.2616291219436692, 0.24832986796148843, 0.2210483529336682, 0.21842912864119343, 0.20294426517540484, 0.17938916829658283, 0.17360119432210333, 0.16478861853237636, 0.13552353302029416, 0.07451700267504169, 0.06905081226539268, 0.05874661663688848, 0.05586243828161624, 0.050858767231196936, 0.04966748828423029, 0.037581200259312504, 0.0315715945959057, 0.022060840303432035, 0.01870803313768205, 0.018632027745551238, 0.01668644129989437, 0.015108760149997303, 0.01447701427855121, 0.01398955727970466, 0.010511540447665028, 0.010116723368226771, 0.008384613938465917, 0.00801056603434145, 0.0009268001255290788, 0.0008844298420255227, 0.0008744357532915953, 0.0008646650078877973, 0.0008551102017829906, 0.0008551102017829906, 0.0008551102017829906, 0.0008457642546361693, 0.0008457642546361693, 0.0008276721304401041, 0.0008276721304401041, 0.0008276721304401041, 0.0008276721304401041, 0.0008189132592119505, 0.0008189132592119505, 0.0008103378288773993, 0.0008103378288773993, 0.0008103378288773993, 0.0008019401363327459, 0.0007937147124590597, 0.0007937147124590597, 0.0007937147124590597, 0.0007856563102442172, 0.0007856563102442172, 0.0007777598936212276, 0.0007777598936212276, 0.00077002062697296, 0.0007624338652573074, 0.0007624338652573074, 0.0007624338652573074, 0.0007549951447104176, 0.0007549951447104176, 0.0007477001740888923, 0.0007405448264148475, 0.000733525131190471, 0.000733525131190471, 0.0007266372670512163, 0.0007198775548290677, 0.0007198775548290677, 0.0007198775548290677, 0.0007198775548290677, 0.0007132424509994203, 0.0007132424509994203, 0.0007067285414870515, 0.0007067285414870515, 0.0007067285414870515, 0.0006940512615292696, 0.0006878816590176454, 0.0006878816590176454, 0.0006818207764745515, 0.0006818207764745515, 0.0006758657652248318, 0.0006758657652248318, 0.0006700138752527646, 0.0006700138752527646, 0.0006586089271852232, 0.0006586089271852232, 0.0006530508253135594, 0.0006530508253135594, 0.0006475857497291526, 0.0006475857497291526, 0.000642211384334439, 0.0006317258978767365, 0.0006317258978767365, 0.0006317258978767365, 0.0006317258978767365, 0.0006317258978767365, 0.0006215773072467135, 0.000602227888988359, 0.0005975773116546535, 0.0005929980101059264, 0.0005929980101059264, 0.0005796717425749026, 0.0005753617647595538, 0.0005753617647595538, 0.0005753617647595538, 0.0005711154050614171, 0.0005711154050614171, 0.00056693126523193, 0.00056693126523193, 0.0005547387838872481, 0.0005547387838872481, 0.0005468976923587994, 0.0005430596871247705, 0.0005430596871247705, 0.0005355430453837335, 0.0005355430453837335, 0.0005318622181704789, 0.0005318622181704789, 0.0005282316427715907, 0.0005282316427715907, 0.0005246502970836726, 0.0005246502970836726, 0.0005246502970836726, 0.0005176313431677048, 0.0005176313431677048, 0.0005074481173965125, 0.0005041421651608322, 0.0005008790097263305, 0.0004976578254062712, 0.000494477807618367, 0.0004791684512631703, 0.0004704295670054575, 0.00046758701148868153, 0.000464778601747587, 0.00045387440409976054, 0.00045387440409976054, 0.0004460262189172364, 0.0004434701258372639, 0.00043844483467574895, 0.0004240298384326241, 0.0004217189898856411, 0.00041272209239332977, 0.00041272209239332977, 0.0003711520229420144, 0.0003693803744620527, 0.0003244653131029041]
        , "c": [0.6646599409314243, 0.60820131348065, 0.5633055767207031, 0.5594902289376161, 0.47670367745343056, 0.4259426276238532, 0.35379854931084165, 0.3456637677585596, 0.32272770839716713, 0.29775208738843556, 0.2704432683250635, 0.2541214684960173, 0.23307164731018293, 0.22054825451384957, 0.21440923764213685, 0.1098007831106522, 0.09146921231147989, 0.08274639995681198, 0.06201586544027497, 0.06043759828093504, 0.04608650183304859, 0.04294857183228686, 0.04243126145214896, 0.035968216494103825, 0.03329411778104011, 0.030013757109007146, 0.028338497361438567, 0.027620376030053906, 0.02142781109279681, 0.02079421828683836, 0.01971746222716991, 0.009814394874454423, 0.00704571251038874, 0.0005746319086898367, 0.0005286588845514466, 0.0005226850203158324, 0.0005168446572695356, 0.000511133369728735, 0.000511133369728735, 0.000511133369728735, 0.0005055469254920731, 0.0005000812753816122, 0.0005000812753816122, 0.0004947325434549935, 0.0004947325434549935, 0.0004947325434549935, 0.0004894970178390771, 0.00048437114213950783, 0.00048437114213950783, 0.00047935150738442645, 0.00047935150738442645, 0.00047935150738442645, 0.00047935150738442645, 0.00047443484446397713, 0.00047443484446397713, 0.00047443484446397713, 0.0004696180170303742, 0.0004696180170303742, 0.0004648980148261263, 0.0004602719474105932, 0.00045573703825740474, 0.00045573703825740474, 0.00045573703825740474, 0.000451290619197412, 0.000451290619197412, 0.000451290619197412, 0.0004469301251838011, 0.0004469301251838011, 0.00043845713839494953, 0.00043845713839494953, 0.0004343399881137459, 0.0004343399881137459, 0.00043029943932915756, 0.00043029943932915756, 0.00043029943932915756, 0.00043029943932915756, 0.0004263333739356255, 0.0004263333739356255, 0.0004263333739356255, 0.00042243975120463386, 0.00042243975120463386, 0.00041486203688160904, 0.00041486203688160904, 0.00041117422013579305, 0.00040755138963824764, 0.00040755138963824764, 0.0004039918426225588, 0.0004039918426225588, 0.0004004939352949795, 0.0004004939352949795, 0.00039705608030331214, 0.000393676744335044, 0.00039035444583710127, 0.0003870877528500972, 0.0003870877528500972, 0.0003870877528500972, 0.00038387528095042205, 0.00037760768875564363, 0.00037760768875564363, 0.00037760768875564363, 0.00037760768875564363, 0.00037760768875564363, 0.00037760768875564363, 0.0003715414725932062, 0.00035997555590075935, 0.00035997555590075935, 0.00035997555590075935, 0.0003571957209054517, 0.00035445849028099596, 0.00035445849028099596, 0.0003517628920297898, 0.00034910798349859645, 0.0003439166051596887, 0.0003439166051596887, 0.0003439166051596887, 0.00034137838711824413, 0.00034137838711824413, 0.00033887736036636735, 0.00033887736036636735, 0.00033641271342998004, 0.0003315894294516529, 0.0003315894294516529, 0.0003246083689156589, 0.0003246083689156589, 0.00032234621553727205, 0.0003201153732595096, 0.0003201153732595096, 0.00031791519647179597, 0.00031791519647179597, 0.0003157450571917141, 0.0003136043444674218, 0.0003136043444674218, 0.0003136043444674218, 0.00030940883661409625, 0.00030940883661409625, 0.0003033219176505696, 0.0003013458185432707, 0.00029746987083231606, 0.0002955690477520398, 0.00028641803670586874, 0.0002846554131497842, 0.00028119445809693557, 0.0002794953496347734, 0.0002778166514604894, 0.00027615799800642275, 0.0002728994061243215, 0.0002712987789379767, 0.0002712987789379767, 0.0002666076065835429, 0.00026507972811059, 0.00026356926182482014, 0.0002620759117604899, 0.0002605993886216828, 0.0002534594953161386, 0.00025207820925231977, 0.0002467004058735734, 0.0002467004058735734, 0.00024029244654060394, 0.0002207933376502567, 0.00019394581949855455]
        , "d": [0.7849412458479469, 0.7650826591329382, 0.5829611432303123, 0.5570411042919463, 0.5490982022598853, 0.5300089824673503, 0.41615639904301294, 0.3357493390110993, 0.325468191588296, 0.27586385990452317, 0.251082518952091, 0.16334899612120116, 0.08777039290158822, 0.07102901687506448, 0.06594317675876343, 0.05411430521895941, 0.046393628708110216, 0.028484736841989357, 0.01976275860971615, 0.015232675188412172, 0.014171129925286524, 0.013976331463720522, 0.008796015833387334, 0.0004160551819867981, 0.0003827689780097309, 0.0003784436749172177, 0.0003742150317225921, 0.0003700798440637925, 0.0003700798440637925, 0.0003660350476673605, 0.0003660350476673605, 0.00036207771077569935, 0.00036207771077569935, 0.00035820502706030696, 0.00035820502706030696, 0.00035820502706030696, 0.00035820502706030696, 0.00035441430898498625, 0.00035441430898498625, 0.00035070298158604583, 0.00035070298158604583, 0.00035070298158604583, 0.0003470685766392438, 0.0003470685766392438, 0.0003470685766392438, 0.0003470685766392438, 0.00034350872718570533, 0.00034350872718570533, 0.00034350872718570533, 0.00034350872718570533, 0.0003400211623913034, 0.0003400211623913034, 0.0003400211623913034, 0.0003366037027160412, 0.0003366037027160412, 0.0003332542553718428, 0.0003299708100488616, 0.0003299708100488616, 0.0003299708100488616, 0.00032675143489196724, 0.00032675143489196724, 0.00032675143489196724, 0.00032675143489196724, 0.0003235942727104907, 0.0003235942727104907, 0.00032049753740560097, 0.0003174595106008736, 0.0003174595106008736, 0.0003174595106008736, 0.00031447853846269433, 0.0003115530286981368, 0.0003115530286981368, 0.0003115530286981368, 0.0003115530286981368, 0.0003115530286981368, 0.00030868144771886306, 0.00030868144771886306, 0.00030586231796043354, 0.00030586231796043354, 0.0003003757668935108, 0.0002977056484331338, 0.0002977056484331338, 0.0002950825824683491, 0.0002950825824683491, 0.00029250533613202985, 0.00029250533613202985, 0.00028997271925548524, 0.00028997271925548524, 0.0002874835825358353, 0.0002850368157969711, 0.0002850368157969711, 0.0002826313463385702, 0.0002826313463385702, 0.0002802661373680106, 0.0002802661373680106, 0.0002802661373680106, 0.00027794018651036646, 0.00027340221329345436, 0.00027340221329345436, 0.00027340221329345436, 0.00027340221329345436, 0.00027340221329345436, 0.00027340221329345436, 0.0002690100439216061, 0.0002690100439216061, 0.00026063588386966675, 0.00026063588386966675, 0.00026063588386966675, 0.00025862317845359796, 0.000256641320209432, 0.000256641320209432, 0.0002546896053742326, 0.0002527673514314914, 0.0002490085976503428, 0.0002490085976503428, 0.0002490085976503428, 0.0002490085976503428, 0.0002471708320247562, 0.0002471708320247562, 0.00024535999429599445, 0.00024357549692620895, 0.00024357549692620895, 0.00024008325734982985, 0.00024008325734982985, 0.00024008325734982985, 0.0002366897416087153, 0.0002350287061356689, 0.0002350287061356689, 0.0002350287061356689, 0.00023177560776588434, 0.00023177560776588434, 0.00023018259676184453, 0.0002286113340466052, 0.0002286113340466052, 0.0002286113340466052, 0.00022706137726798218, 0.00022706137726798218, 0.00022402367129125997, 0.00022402367129125997, 0.0002196165123103341, 0.00021677349355421336, 0.00021537940962399873, 0.0002140031419983596, 0.0002073774647454924, 0.0002061012587894518, 0.00020359539675397214, 0.00020359539675397214, 0.00020359539675397214, 0.00020114973730904674, 0.00019994880962952028, 0.00019758946616455422, 0.0001964305516921121, 0.0001930339659158271, 0.0001919277242565926, 0.00018868378942939168, 0.00018351423729752784, 0.00017862040152968257, 0.00017862040152968257, 0.00017398079720885528, 0.00016062945160511596]
        , "e": [0.971136700188159, 0.7389508555626972, 0.7027734789936967, 0.6747777140202194, 0.6705416199696722, 0.6575574367571213, 0.6548550903225596, 0.6324655566411499, 0.6320877535214551, 0.618146743329455, 0.6115522179360728, 0.5844948871032044, 0.5819664026687349, 0.5491250477287172, 0.5424811789507444, 0.5302456631137802, 0.5233321997524193, 0.5196200097602892, 0.5137456530731783, 0.5093969943402861, 0.5049884483823209, 0.49604140139986996, 0.49547837716878795, 0.4947286415007986, 0.49266403049569824, 0.49126664606094533, 0.4908285444332197, 0.48965425677501834, 0.48609468471694345, 0.48239477816067894, 0.4813139609662289, 0.48059176238395157, 0.46187653545109286, 0.4497570061932112, 0.4488604097572505, 0.44642867363142696, 0.44410303040341637, 0.44170438608940044, 0.44089343668520375, 0.4311218487463873, 0.4303370770334572, 0.4281941007154248, 0.4235846265030798, 0.41434155908210973, 0.414211715619674, 0.4126612936030644, 0.40979325647672205, 0.4070644058413035, 0.40371742817602524, 0.4034607572818711, 0.39719843389284953, 0.39492645798897036, 0.3933079881718261, 0.38935495718962837, 0.38757160937622387, 0.3862261105195301, 0.3815574005032604, 0.38029450355159966, 0.37666169059096066, 0.3720615241484042, 0.3694499951546433, 0.3692445206287091, 0.3624789815751492, 0.3605622494990898, 0.35617559483654726, 0.3559501925791362, 0.3552396405637565, 0.3489030853868469, 0.3460575853847927, 0.3428335016684399, 0.34222649859548726, 0.34177297135568185, 0.33928064971161237, 0.33856241682244437, 0.3368010334342587, 0.3303218413856637, 0.3294058640316128, 0.3291759528386036, 0.3284632207240608, 0.3262020767814152, 0.325032958227707, 0.3207203970759425, 0.3198505080478637, 0.31899987235139377, 0.3170529683833281, 0.312143712213582, 0.31157356382555484, 0.31070754911271237, 0.3088981479506394, 0.30804749653413743, 0.303462839969103, 0.30290268832602013, 0.30290268832602013, 0.30148175016293105, 0.29174306543616163, 0.290714261481458, 0.28359445515401976, 0.27480761406216725, 0.2732468629564878, 0.27178908916670486, 0.27144764620258804, 0.271264592206515, 0.271264592206515, 0.2703522059650208, 0.2694254515740336, 0.2680217150161454, 0.26785018309963415, 0.26572666697811065, 0.2656143661052142, 0.2648437372306402, 0.2591037188167096, 0.25905974186581077, 0.2585456163203334, 0.2508081862028958, 0.24923167588722442, 0.24887161024690155, 0.24709546467729082, 0.24680620505477527, 0.24601185463810066, 0.24481019542594745, 0.243982316833062, 0.24394738272833302, 0.2325142297482302, 0.2283709967553771, 0.22773672211271614, 0.22520180281853341, 0.22340860224914177, 0.2233436920632964, 0.22305125388497313, 0.21949019386994353, 0.21797367475357948, 0.21573772204254685, 0.2151864337200178, 0.21273347706093645, 0.211122779238362, 0.2084065564882658, 0.20707139007254768, 0.20702895901234505, 0.20674666083598703, 0.20223198174513488, 0.19220400889526526, 0.1849707938470862, 0.16768583411661836, 0.16492376891129235, 0.1529771946883656, 0.15287402615555323, 0.15243014498897545, 0.14718238894040656, 0.14619803022702316, 0.14380159208246607, 0.14263624799434937, 0.14258052519344655, 0.13625270245382334, 0.13460840132281565, 0.10477541087064762, 0.10301213119998302, 0.0976474422925182, 0.08020066339630201, 0.07837986953326928, 0.06497615169939946]
}
